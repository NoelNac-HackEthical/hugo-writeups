/* ==========================================================================
   Custom site CSS – PaperMod (Noël)  [A1] Variables globales
   ========================================================================== */

:root{
  /* Layout TOC */
  --toc-width: 240px;
  --toc_droite: 0;        /* 1 = TOC à droite (défaut thème), 0 = TOC à gauche */
  --toc-stick: 2rem;      /* offset sticky des titres */
  --toc-align-box: 1.8rem;/* décale visuellement le panneau TOC */
  --toc-align-tweak: 0rem;

  /* Cadres */
  --summary-border: #555;

  /* Tags (clair) */
  --tag-fg: #1E90FF;
  --tag-bg: rgba(127,127,127,.15);
  --tag-fg-hover-light: #003366;
  --tag-bg-hover-light: rgba(127,127,127,.40);

  /* TOC active */
  --toc-active: #1E90FF;
}
html.dark, body.dark{
  --summary-border: #ccc;
  --tag-fg: #9ecbff;
  --tag-bg: rgba(255,255,255,.15);
  --tag-fg-hover-dark: #ffffff;
  --tag-bg-hover-dark: rgba(255,255,255,.30);
  --toc-active: #9ecbff;
}


/* ==========================================================================
   [B1] Mise en page des articles (grille de base: article | TOC)
   ========================================================================== */

.post-single{ display:block; } /* garde-fou si un style met flex */

.post-content{
  display:grid;
  grid-template-columns: minmax(0,1fr) var(--toc-width,320px);
  column-gap: 2rem;
  align-items:start;
}

/* Panneau TOC sticky (sans scrollbar interne) */
.post-content > #TableOfContents{
  grid-column:2;
  grid-row:1;
  position: sticky;
  top: var(--toc-stick);
  margin-top: var(--toc-align-box);
  z-index:5;

  max-height:none;
  overflow:visible;

  background: var(--entry);
  border:1px solid var(--border);
  border-radius:10px;
  padding:.75rem 1rem;
}

/* Neutralise l’ancienne astuce de décalage interne */
.post-content > #TableOfContents > ul{
  margin-top:0;
  transform:none;
}

.post-content > .post-article{
  grid-column:1;
  min-width:0;
}

/* Aligne les ancres des titres avec le haut du viewport */
.post-content h2,
.post-content h3,
.post-content h4{
  scroll-margin-top: var(--toc-stick);
}

/* Mobile (<= 991px) : TOC sous le contenu — comportement conservé */
@media (max-width: 991px){
  .post-content{ display:block; }
  .post-content > #TableOfContents{ position:static; margin-top:1rem; }
}


/* ==========================================================================
   [C1] HEADER d’article : résumé + vignette 120×120 + tags
   ========================================================================== */

.post-intro{ max-width:860px; margin:.25rem 0 .75rem; }

.post-intro .summary-image-row{
  display:flex; align-items:flex-start; gap:.75rem;
  border:1px solid var(--summary-border);
  border-radius:8px; padding:.75rem;
}
.post-intro .post-summary{ margin:0; }

.post-intro .thumb-wrap{
  display:block; border-radius:10px; overflow:hidden;
  flex-shrink:0; width:120px; height:120px;
}
.post-intro .thumb-wrap img{
  display:block; width:100%; height:100%; object-fit:cover;
}


/* ==========================================================================
   [D1] HOME : liste + cartes (résumé + vignette)
   ========================================================================== */

.home-min{ max-width:860px; margin:0 auto; padding:1rem; }

.post-list{ list-style:none; margin:0; padding:0; display:grid; gap:1rem; }
.post-item{ border-bottom:1px solid var(--border, rgba(127,127,127,.25)); padding-bottom:1rem; }
.post-title{ font-size:1.2rem; margin:0 0 .25rem; }
.post-title a{ text-decoration:none; }
.post-meta{ font-size:.9rem; opacity:.8; margin-bottom:.35rem; }
.post-summary{ margin:0; }

.summary-image-row{
  display:flex; align-items:flex-start; gap:.75rem; margin-top:.25rem;
  border:1px solid var(--summary-border);
  border-radius:8px; padding:.75rem;
}
.thumb-wrap{
  display:block; border-radius:10px; overflow:hidden;
  flex-shrink:0; width:120px; height:120px;
}
.thumb-wrap img{ display:block; width:100%; height:100%; object-fit:cover; }

.pager{ display:flex; gap:.75rem; justify-content:center; margin-top:1rem; }

@media (max-width:720px){
  .summary-image-row{ flex-direction:column; }
  .thumb-wrap{ width:100%; max-width:240px; height:auto; aspect-ratio:1/1; }
}


/* ==========================================================================
   [E1] Tags unifiés (home + writeups)
   ========================================================================== */

.post-tags{ display:flex; flex-wrap:wrap; gap:.4rem; margin-top:.25rem; }

.post-tags .tag{
  font-size:.85rem; font-weight:700; text-decoration:none;
  color:var(--tag-fg); background-color:var(--tag-bg);
  padding:.08rem .4rem; border-radius:999px; transition:.2s; outline:none;
}

html:not(.dark) .post-tags .tag:hover,
html:not(.dark) .post-tags .tag:focus-visible{
  color:var(--tag-fg-hover-light) !important;
  background-color:var(--tag-bg-hover-light) !important;
}

html.dark .post-tags .tag:hover,
html.dark .post-tags .tag:focus-visible,
body.dark .post-tags .tag:hover,
body.dark .post-tags .tag:focus-visible{
  color:var(--tag-fg-hover-dark) !important;
  background-color:var(--tag-bg-hover-dark) !important;
}

.post-tags .tag:focus-visible{
  outline:2px solid currentColor; outline-offset:2px;
}


/* ==========================================================================
   [F1] Surlignage Search (occurrences & active)
   ========================================================================== */

mark.__hl{ background:none; font-weight:700; }
html.dark mark.__hl{ color:#ffe066; }
html:not(.dark) mark.__hl{ color:#e67e22; }
mark.__hl.__hl-active{ background:#ffea70; }
html.dark mark.__hl.__hl-active{ color:#111; }
html:not(.dark) mark.__hl.__hl-active{ color:#b65e0e; }

.__hl-nav{
  position:fixed; right:.75rem; bottom:.75rem; z-index:9999;
  display:flex; align-items:center; gap:.35rem;
  background:var(--entry); border:1px solid var(--border);
  border-radius:8px; padding:.35rem .5rem;
}


/* ==========================================================================
   [G1] Numérotation automatique dans le CONTENU (H2/H3/H4)
   (non appliquée à la TOC)
   ========================================================================== */

.post-content{ counter-reset:h2counter; }
.post-content h2{ counter-reset:h3counter; }
.post-content h3{ counter-reset:h4counter; }

.post-content h2::before{
  counter-increment:h2counter;
  content: counter(h2counter) ". ";
  font-weight:600; margin-right:.25em;
}
.post-content h3::before{
  counter-increment:h3counter;
  content: counter(h2counter) "." counter(h3counter) " ";
  margin-right:.25em;
}
.post-content h4::before{
  counter-increment:h4counter;
  content: counter(h2counter) "." counter(h3counter) "." counter(h4counter) " ";
  margin-right:.25em;
}

.post-content h2.nonum::before,
.post-content h3.nonum::before,
.post-content h4.nonum::before{
  content:""; counter-increment:none;
}


/* ==========================================================================
   [H1] TOC – styles PaperMod + numérotation + liens non soulignés
   ========================================================================== */

#TableOfContents{ font-size:.90rem; } /* compact */

#TableOfContents a{ text-decoration:none !important; }
#TableOfContents a:hover{ text-decoration:none !important; }

/* Numérotation H2 */
#TableOfContents > ul{ counter-reset: toc-h2; }
#TableOfContents > ul > li{ counter-increment: toc-h2; }
#TableOfContents > ul > li > a::before{
  content: counter(toc-h2) ". ";
  margin-right:.25em;
}

/* Numérotation H3 */
#TableOfContents ul ul{ counter-reset: toc-h3; padding-left:1.15rem; }
#TableOfContents ul ul > li{ counter-increment: toc-h3; }
#TableOfContents ul ul > li > a::before{
  content: counter(toc-h2) "." counter(toc-h3) " ";
  margin-right:.25em;
}

/* Numérotation H4 */
#TableOfContents ul ul ul{ counter-reset: toc-h4; }
#TableOfContents ul ul ul > li{ counter-increment: toc-h4; }
#TableOfContents ul ul ul > li > a::before{
  content: counter(toc-h2) "." counter(toc-h3) "." counter(toc-h4) " ";
  margin-right:.25em;
}

/* Densité desktop */
@media (min-width: 992px){
  #TableOfContents a{ line-height:1.12 !important; }
  #TableOfContents li{ margin:.06rem 0 !important; }
  #TableOfContents ul{ margin:.10rem 0 !important; }
  #TableOfContents ul ul{ margin-top:.06rem !important; }
}

/* Neutraliser tous les soulignés possibles (thème) */
.post-content > #TableOfContents a,
.post-content > #TableOfContents a:link,
.post-content > #TableOfContents a:visited,
.post-content > #TableOfContents a:hover,
.post-content > #TableOfContents a:focus,
.post-content > #TableOfContents a:active{
  text-decoration:none !important;
  -webkit-text-decoration:none !important;
  text-decoration-line:none !important;
  border:0 !important; border-bottom:0 !important;
  box-shadow:none !important;
  background-image:none !important;
  background-size:0 0 !important;
  background-repeat:no-repeat !important;
  background-position:0 100% !important;
}
.post-content > #TableOfContents a::after{
  box-shadow:none !important;
  background-image:none !important;
  border:0 !important;
}

/* Item actif */
#TableOfContents a.is-active{
  color:var(--toc-active) !important;
  font-weight:600;
  text-decoration:none !important;
  border:0 !important;
  box-shadow:none !important;
  background-image:none !important;
}

/* Auto-collapse + chevrons (desktop) */
#TableOfContents li > ul{ display:none; }
#TableOfContents li.is-open > ul{ display:block; }
#TableOfContents li.has-children > a{
  position:relative; padding-right:1rem;
}
#TableOfContents li.has-children > a::after{
  content:"▸";
  position:absolute; right:0; top:.05rem;
  font-size:.9em; opacity:.8;
  transform:translateY(.1rem) rotate(0deg);
  transition:transform .15s ease;
}
#TableOfContents li.has-children.is-open > a::after{
  transform:translateY(.1rem) rotate(90deg);
}

/* Mobile : pas de repli (tout visible) */
@media (max-width: 991px){
  #TableOfContents li > ul{ display:block; }
  #TableOfContents li.has-children > a{ padding-right:0; }
  #TableOfContents li.has-children > a::after{ display:none; }
}


/* ==========================================================================
   [I1] HOME uniquement : clamp des résumés à exactement 4 lignes
   ========================================================================== */

.home-min .post-summary,
.home-min .post-entry .post-content,
.home-min .post-entry .entry-content,
.home-min .post-entry p{
  line-height:1.55;
  display:-webkit-box;
  -webkit-box-orient:vertical;
  -webkit-line-clamp: 4;
  overflow:hidden;
  min-height:calc(1.55em * 4);
  max-height:calc(1.55em * 4);

  display: -webkit-box;
  -webkit-box-orient: vertical;
  overflow: hidden;
}


/* ==========================================================================
   [J1] Desktop uniquement : TOC gauche/droite pilotée par --toc_droite
   ========================================================================== */

@media (min-width: 992px){
  .post-content{
    display:flex;               /* remplace la grille en desktop */
    align-items:flex-start;
    gap:2rem;                   /* identique au column-gap */
  }
  #TableOfContents{
    order: var(--toc_droite);   /* 1 => droite, 0 => gauche */
    flex: 0 0 var(--toc-width,320px);
    max-width: var(--toc-width,320px);
  }
  .post-article{
    order: calc(1 - var(--toc_droite));
    min-width:0;
    flex:1 1 auto;
  }
}

/* === PaperMod: désactiver la barre de défilement horizontale du menu en desktop === */
@media (hover: hover) and (min-width: 768px) {
  .header .nav ul.menu {
    overflow-x: visible !important;   /* pas de scroll horizontal */
    -ms-overflow-style: none !important; /* IE/Edge legacy */
    scrollbar-width: none !important;     /* Firefox */
  }
  .header .nav ul.menu::-webkit-scrollbar { display: none !important; } /* Chrome/Safari */
}

/* ======= Outils > Sous-menus (look soigné) ======= */

/* ancre et curseur */
#menu > li.has-children { position: relative; }
#menu > li.has-children > a,
#menu > li.has-children > .menu-parent { cursor: default; }

/* conteneur du dropdown */


/* ouverture au survol / focus clavier (desktop) */


/* items internes */
#menu > li.has-children > ul.submenu > li { margin: 0; }
#menu > li.has-children > ul.submenu > li > a {
  display: block;
  padding: .55rem .9rem;
  white-space: nowrap;
  text-decoration: none;
  border: 0;
  background: transparent;
  line-height: 1.2;
}

/* hover doux (compatible dark) */
#menu > li.has-children > ul.submenu > li > a:hover,
#menu > li.has-children > ul.submenu > li > a:focus {
  background: rgba(255,255,255,.06);
  outline: none;
}

/* évite que quelque chose masque le dropdown */
.header, .nav { position: relative; z-index: 1100; overflow: visible; }

/* supprime tout soulignement/trait fantôme sur les liens du header */
.header .nav ul.menu > li > a,
.header .nav ul.menu > li > a > span,
.header .nav ul.menu > li > a::before,
.header .nav ul.menu > li > a::after,
.header .nav ul.menu > li > a > span::before,
.header .nav ul.menu > li > a > span::after {
  text-decoration: none !important;
  background: none !important;
  background-image: none !important;
  border: 0 !important;
  box-shadow: none !important;
  outline: 0 !important;
  content: none !important;
}

/* pas de barre de scroll horizontale du menu en desktop */
@media (hover: hover) and (min-width: 768px) {
  .header .nav ul.menu { overflow-x: visible !important; }
  .header .nav ul.menu::-webkit-scrollbar { display: none !important; }
}

/* ---------- options esthétiques (facultatives) ---------- */

/* petit caret ▼ sur le parent */
#menu > li.has-children > a > span::after,
#menu > li.has-children > .menu-parent > span::after {
  content: " ▾";
  opacity: .7;
  font-size: .9em;
}

/* aligner le dropdown sur la droite du parent (si l’item est en bout de ligne) */
/* activer au besoin sur l'élément concerné avec une classe .align-right */
#menu > li.has-children.align-right > ul.submenu {
  left: auto; right: 0;
}

/* =========================
   Bloc Usage (mes-scripts)
   ========================= */

/* Conteneur encadré */
.usage-box{
  border:1px solid var(--border);
  background:var(--entry);
  border-radius:.5rem;
  padding:.75rem 1rem;
  margin:1rem 0;
}

/* Titre "Usage" */
.usage-box .usage-title{
  font-weight:600;
  opacity:.85;
  margin:0 0 .25rem 0;
}

/* Zone de code neutre : pas de coloration syntaxique */
.usage-box pre.usage-pre{
  margin:0;
  white-space:pre;          /* garde les retours à la ligne, pas de wrap */
  overflow:auto;            /* scroll horizontal si trop long */
  background:transparent;   /* fond neutre */
  color:inherit;            /* texte hérite de la couleur du thème */
  line-height:1.35;
  tab-size:4;
  font-family: var(--mono, ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace);
  font-size:.95rem;
}

/* Code à l’intérieur */
.usage-box pre.usage-pre code{
  white-space:inherit;
  background:transparent;
  color:inherit;            /* supprime toute coloration syntaxique */
}

/* Neutraliser le multi-colonnes sans toucher au grid/layout */
.post-article.no-cols,
.post-article.no-cols * {
  -webkit-columns: auto !important;
  -moz-columns: auto !important;
  columns: auto !important;

  -webkit-column-count: 1 !important;
  -moz-column-count: 1 !important;
  column-count: 1 !important;

  -webkit-column-width: auto !important;
  -moz-column-width: auto !important;
  column-width: auto !important;

  -webkit-column-gap: normal !important;
  -moz-column-gap: normal !important;
  column-gap: normal !important;
}

.usage-box .usage-title{
  font-weight:600;
  opacity:.85;
  margin:0 0 .25rem 0;
}

/* Bloc Usage : pas de wrap + scroll horizontal si nécessaire */
.usage-box .highlight,
.usage-box pre {
  overflow-x: auto;          /* barre horizontale si ça dépasse */
  overflow-y: hidden;
}

.usage-box pre,
.usage-box code {
  white-space: pre !important;   /* ne jamais couper les lignes */
  word-break: normal !important; /* pas de césure */
}

/* --- Bloc "Télécharger le script" : 1 ligne texte + 2 boutons --- */

/* Ligne de version (texte simple) */
.version-line{
  margin:.25rem 0 .5rem;
  font-size:.95rem;
  color:var(--content);
}

/* Barre boutons */
.dl-row{
  display:flex;
  align-items:center;
  gap:.75rem;
  flex-wrap:wrap;
  margin:.75rem 0 1rem;
}

/* Boutons harmonisés (même look que la pastille d'avant) */
.dl-row .he-btn{
  display:inline-flex;
  align-items:center;
  padding:.45rem .85rem;
  font-size:.9rem;
  border-radius:.6rem;
  box-shadow:0 1px 2px rgba(0,0,0,.12);
  min-height:2.2rem;
}

/* Variante neutre + hover */
.he-btn--neutral{
  background:#3a3a3a;
  border-color:var(--border);
  color:var(--content);
}
.he-btn--neutral:hover{
  background:#505050;
  filter:brightness(1.08);
  transform:translateY(-1px);
}

/* Bouton compact (SHA256) */
.dl-row .he-btn.he-btn--sm{
  padding:.32rem .6rem;
  font-size:.78rem;
  min-height:1.8rem;
}

/* Focus propre */
.dl-row .he-btn:focus,
.dl-row .he-btn:active,
.dl-row .he-btn:focus-visible{
  outline:none;
  box-shadow:none;
}

/* ==================== AJOUT : MENU OUTILS COMPAT MOBILE/DESKTOP (PaperMod) ==================== */
/* Ne pas clipper les sous-menus */
.header, .nav, header, nav { overflow: visible !important; }

/* A) Cas PaperMod mobile natif : <details><summary>Outils</summary><ul>… */
.header .menu summary { cursor: pointer; list-style: none; }
.header .menu summary::-webkit-details-marker { display: none; }
.header .menu details > ul { display: none; }
.header .menu details[open] > ul { display: block; }

/* B) Cas “classique” : <li class="has-children"><a>Outils</a><ul>…</ul></li> */
@media (hover: none) {
  /* Par défaut, rien n’est visible sans ouverture explicite */
  #menu > li.has-children > ul,
  .menu > li.has-children > ul,
  nav .menu > li.has-children > ul { display: none !important; }

  /* Affiché si le parent porte .is-open (ajouté par JS si besoin) */
  #menu > li.has-children.is-open > ul,
  .menu > li.has-children.is-open > ul,
  nav .menu > li.has-children.is-open > ul { display: block !important; }
}

/* Sécurité : au-dessus des autres calques */
.header .menu details > ul,
#menu > li.has-children > ul,
.menu > li.has-children > ul { position: relative; z-index: 1200; }

/* Un peu d’air quand ouvert */
.header .menu details[open] > ul,
#menu > li.has-children.is-open > ul { margin-top: .25rem; }

/* ======= Outils > Sous-menus (desktop + mobile, PaperMod) ======= */

/* Le parent doit pouvoir positionner son dropdown */
#menu > li.has-children { position: relative; }
#menu > li.has-children > a,
#menu > li.has-children > .menu-parent { cursor: default; }

/* Styles visuels du dropdown (look desktop conservé) */
#menu > li.has-children > ul {
  position: absolute;
  top: 100%;
  left: 0;
  z-index: 1200;
  min-width: 14rem;
  margin: 0;
  padding: 0.35rem 0;
  list-style: none;
  background: var(--entry);
  border: 1px solid var(--border);
  border-radius: 0.5rem;
  box-shadow: 0 12px 28px rgba(0,0,0,0.22);
  display: none; /* caché par défaut */
}

/* Desktop (pointeur/hover) : ouvrir au survol */
@media (hover: hover) {
  #menu > li.has-children:hover > ul,
  #menu > li.has-children:focus-within > ul { display: block; }
}

/* Mobile (pas de hover) : ouverture via .is-open (voir mini-JS tap-to-open) */
@media (hover: none) {
  #menu > li.has-children.is-open > ul { display: block; }
}

/* Compat PaperMod quand le menu mobile est rendu en <details> */
.header .menu summary { cursor: pointer; list-style: none; }
.header .menu summary::-webkit-details-marker { display: none; }
.header .menu details > ul { display: none; }
.header .menu details[open] > ul { display: block; }

/* Eviter le clipping */
.header, .nav, header, nav { overflow: visible !important; }

/* ============================================================
   Outils (_index.md) : mise en page bouton + texte
   ============================================================ */

/* Conteneur général : empile les lignes */
.post-content .tools-list {
  display: flex;
  flex-direction: column;
  gap: 0.6rem;             /* espace vertical entre les lignes */
  margin: 0.5rem 0 1rem;
}

/* Chaque ligne = bouton + texte */
.post-content .tools-list .tool-item {
  display: flex;
  align-items: center;
  gap: 0.8rem;             /* espace horizontal bouton ↔ texte */
  margin: 0 !important;    /* neutralise marges éventuelles du shortcode dl-row */
}

/* Boutons : gardent le look natif (comme Téléchargements) */
.post-content .tools-list .he-btn,
.post-content .tools-list .he-btn--neutral,
.post-content .tools-list .he-btn--sm {
  margin: 0 !important;
  padding-left: 0.85rem;   /* plus d’espace interne */
  padding-right: 0.85rem;
  border-radius: 999px;    /* arrondi style “pill” */
  text-decoration: none !important;
}

/* Texte à droite : sobre, sans souligné et resserré */
.post-content .tools-list .tool-item span {
  text-decoration: none !important;
  line-height: 1.2;        /* hauteur de ligne resserrée */
}

/* ===== Listes en cartes (recettes) ===== */
.list-cards {
  display: flex;
  flex-direction: column;
  gap: 1.25rem;
  margin-top: 0.75rem;
}
.list-card {
  display: block;
  background: var(--entry);
  border: 1px solid var(--border);
  border-radius: .75rem;
  padding: 1.1rem 1.25rem;
  text-decoration: none;
  color: inherit;
  box-shadow: 0 10px 24px rgba(0,0,0,.14);
  transition: transform .06s ease, box-shadow .15s ease, border-color .15s ease;
}
.list-card:hover {
  transform: translateY(-2px);
  box-shadow: 0 14px 32px rgba(0,0,0,.18);
  border-color: var(--border);
}
.list-card__title {
  margin: 0 0 .35rem 0;
  font-size: 1.6rem;
  line-height: 1.25;
}
.list-card__desc {
  margin: 0;
  opacity: .85;
}

/* empêcher l’affichage en colonnes sur cette section si le thème en met */
.post-content.no-cols, .no-cols { column-count: 1 !important; columns: auto !important; }

/* Masquer la flèche native PaperMod */
#top-link,
#top-link.show { display: none !important; }

/* Bouton Back-to-Top — pastille visible + icône épaisse (SVG via mask) */
button.back-to-top{
  position: fixed; right: 1rem; bottom: 1rem; z-index: 1000;
  width: 52px; height: 52px; border-radius: 999px;
  border: 1px solid var(--border);
  background: var(--theme); color: var(--primary); /* currentColor = var(--primary) */
  text-align: center; cursor: pointer;
  box-shadow: 0 10px 24px rgba(0,0,0,.20);
  transition: transform .18s ease, opacity .18s ease, box-shadow .18s ease;
  opacity: .97;
  /* On masque visuellement le texte, mais on le laisse pour l’accessibilité */
  font-size: 0;
}
button.back-to-top:hover{ transform: translateY(-2px); box-shadow: 0 14px 30px rgba(0,0,0,.22); }
button.back-to-top:active{ transform: translateY(0); }
button.back-to-top[hidden]{ display: none !important; }

/* Icône flèche épaisse (teintée par currentColor) */
/* Icône flèche épaisse (teinte = currentColor) */
button.back-to-top::before{
  content: "";
  display: inline-block;
  width: 26px; height: 26px;
  margin-top: 13px; /* centré verticalement dans 52px */
  background-color: currentColor;

  /* SVG URL-encodé (une seule ligne) */
  -webkit-mask: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath d='M12 19V5' fill='none' stroke='white' stroke-width='3' stroke-linecap='round' stroke-linejoin='round'/%3E%3Cpath d='M5 12l7-7 7 7' fill='none' stroke='white' stroke-width='3' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E") no-repeat center / 26px 26px;
          mask: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath d='M12 19V5' fill='none' stroke='white' stroke-width='3' stroke-linecap='round' stroke-linejoin='round'/%3E%3Cpath d='M5 12l7-7 7 7' fill='none' stroke='white' stroke-width='3' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E") no-repeat center / 26px 26px;
}

/* Focus clavier bien visible */
button.back-to-top:focus-visible{
  outline: 2px solid currentColor;
  outline-offset: 3px;
}

/* Optionnel : micro-ajustement sur très petits écrans */
@media (max-width: 380px){
  button.back-to-top{ right: .6rem; bottom: .6rem; }
}

/* === Plus d'espace pour la colonne CONTENU (desktop) === */
@media (min-width: 992px){
  /* Si PaperMod lit --content-width (cas le plus propre) */
  :root { --content-width: 1280px; }   /* essaie 1140/1200/1240/1280 */

  /* Et on réduit légèrement l'écart contenu↔TOC si tu veux */
  .post-content { gap: 1.4rem; }       /* avant: 2rem */
}

/* Si ton thème ignorerait --content-width, force le max-width : */
@media (min-width: 992px){
  .post-single { max-width: 1280px; }  /* garde la valeur en phase avec ci-dessus */
}

/* Script intro box = largeur de la phrase, wrap si trop long, texte centré */
.post-article .script-desc-box{
  display: inline-block;          /* shrink-wrap */
  width: -moz-fit-content;
  width: fit-content;             /* largeur = contenu, jusqu'à 100% */
  max-width: 100%;
  white-space: normal;            /* autorise les retours à la ligne */
  text-align: center;             /* centre le texte à l’intérieur */
  overflow-wrap: anywhere;        /* gère les mots/tokens très longs */
  box-sizing: border-box;

  margin: 1rem 0 2rem 0;          /* alignée au flux du texte (pas centrée) */
  padding: .85rem .9rem;          /* marges internes confort */
  border: 1px solid var(--border, #ddd);
  border-radius: .75rem;
  background: var(--card-bg, rgba(0,0,0,.03));
}

.post-article .script-desc-box p{ margin: 0; }

/* ——— Script intro box : dark mode (bordure + fond + texte) ——— */
@media (prefers-color-scheme: dark){
  .script-desc-box{
    /* Visibilité */
    border-color: rgba(255,255,255,.36);
    border-width: 2px;
    background: rgba(255,255,255,.06);

    /* Texte un peu plus “flashy” */
    color: rgba(255,255,255,.94);
    font-weight: 600;
    text-shadow: 0 0 6px rgba(255,255,255,.06);
    letter-spacing: .1px;
  }
  .script-desc-box a{
    color: #a5b4fc;
    text-decoration-thickness: .12em;
    text-underline-offset: .18em;
  }
}

/* Compatibilité thèmes dark pilotés par classe/attr (PaperMod) */
.dark .script-desc-box,
html[data-theme="dark"] .script-desc-box{
  border-color: rgba(255,255,255,.36);
  border-width: 2px;
  background: rgba(255,255,255,.06);
  color: rgba(255,255,255,.94);
  font-weight: 600;
  text-shadow: 0 0 6px rgba(255,255,255,.06);
  letter-spacing: .1px;
}
.dark .script-desc-box a,
html[data-theme="dark"] .script-desc-box a{
  color: #a5b4fc;
  text-decoration-thickness: .12em;
  text-underline-offset: .18em;
}

/* ——— Harmonisation /outils/ avec les listes ——— */

/* Grille cartes (mêmes gouttières/largeur visuelle) */
.he-cards-grid{
  margin: 0 auto;
  max-width: 960px;             /* même largeur que tes listes */
  padding: 0 1rem 2rem 1rem;
}
@media (min-width: 640px){
  .he-cards-grid{ padding: 0 1.25rem 2.5rem 1.25rem; }
}

/* Contenu bouton-liste existant, rendu "carte" */
.tools-list{
  display: grid;
  grid-template-columns: 1fr;
  gap: 0.75rem;
}
@media (min-width: 700px){
  .tools-list{
    grid-template-columns: 1fr 1fr 1fr; /* 3 colonnes comme tes cartes */
    gap: 1rem;
  }
}

.tool-item{
  border: 1px solid rgba(0,0,0,.12);
  border-radius: 14px;
  padding: .85rem 1rem;
  background: rgba(0,0,0,.02);
  transition: transform .12s ease, box-shadow .12s ease;
}
.tool-item:hover{
  transform: translateY(-1px);
  box-shadow: 0 4px 14px rgba(0,0,0,.08);
}

/* Ligne bouton + texte (tu utilises déjà .dl-row) */
.tool-item.dl-row{
  display: flex;
  align-items: center;
  gap: .75rem;
}
.tool-item .he-btn--neutral{
  white-space: nowrap;
}

/* Texte sous le bouton */
.tool-item span{
  font-size: .95rem;
  opacity: .9;
}

/* ======================================================================
   Desktop : contenu large, TOC figée (plafond 1240px)
   Optimisé pour lecture fluide (~66 caractères/ligne sur écran 2560x1600)
   ====================================================================== */

/* 1) TOC : largeur fixe en desktop (ne pas l'élargir) */
@media (min-width: 992px){
  :root{
    --toc-width: 240px;          /* largeur constante */
  }
  .post-content{ gap: 2rem; }    /* écart contenu ↔ TOC constant */
}

/* 2) Conteneur fluide (singles + listes) — plafond 1240px */
@media (min-width: 992px){
  .main,
  .post-single,
  .list{
    /* min 1080px, fluide à 86vw, max 1240px */
    max-width: clamp(1080px, 86vw, 1240px);
    margin-inline: auto;
    padding-inline: clamp(12px, 1.6vw, 28px);
  }
}

/* 3) Grilles (outils, références, listes) adaptatives */
.post-list{
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  gap: clamp(.85rem, 1.4vw, 1.4rem);
}

/* 4) Sécurité : pas de débordement des éléments larges */
.post-content .highlight,
.post-content pre,
.post-content table,
.post-content img{
  max-width: 100%;
  box-sizing: border-box;
  margin-inline: 0;
  overflow: auto;
}

/* ============================================================
   Variante esthétique : listes multi-colonnes “cartes”
   (Home + _index.md/sections)
   ============================================================ */

/* Grille fluide, cartes de largeur confortable */
.home .post-list,
.list .post-list{
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); /* 1→n colonnes */
  gap: 1.1rem 1.2rem; /* vertical | horizontal */
  align-items: stretch;
}

/* Ultra-wide : colonnes un peu plus larges pour aérer */
@media (min-width: 1600px){
  .home .post-list,
  .list .post-list{
    grid-template-columns: repeat(auto-fit, minmax(360px, 1fr));
    gap: 1.2rem 1.4rem;
  }
}

/* Carte harmonisée (respecte l’overlay .entry-link de PaperMod) */
.post-entry{
  display: flex;                 /* hauteur homogène */
  flex-direction: column;
  background: var(--entry);
  border: 1px solid var(--border);
  border-radius: 14px;
  padding: 1rem 1.1rem;
  box-shadow: 0 6px 16px rgba(0,0,0,.08);
  transition: transform .08s ease, box-shadow .15s ease, border-color .15s ease;
}
.post-entry:hover,
.post-entry:focus-within{
  transform: translateY(-2px);
  box-shadow: 0 12px 28px rgba(0,0,0,.16);
  border-color: var(--border);
}

/* Titre + résumé compacts et élégants */
.entry-header{ margin: 0 0 .35rem; }
.entry-title{
  margin: 0;
  font-size: 1.25rem;
  line-height: 1.25;
}

/* Résumé clampé (évite les hauteurs erratiques) */
.post-entry .entry-content{ flex: 1 1 auto; }
.post-entry .entry-content p{
  margin: 0;
  line-height: 1.55;
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-line-clamp: 5;      /* 4–5 lignes : ajuste si tu veux */
  overflow: hidden;
  min-height: calc(1.55em * 3); /* garde un minimum même si court */
}

/* Overlay cliquable : au-dessus du contenu, sans gêner le focus */
.post-entry .entry-link{ z-index: 1; }

/* Accessibilité focus clavier (cartes) */
.post-entry :is(a, button, .entry-link):focus-visible{
  outline: 2px solid var(--toc-active, #1E90FF);
  outline-offset: 3px;
  border-radius: 10px;
}

/* ============================================================
   Multi-colonnes robustes (toutes sections concernées)
   - Home et pages _index.md classiques  -> .post-list
   - /recettes/ (ta liste personnalisée) -> .list-cards
   - /mes-scripts/ (boutons)             -> .tools-list
   ============================================================ */

@media (min-width: 992px){
  /* Listes PaperMod classiques */
  .post-list{
    display: grid !important;
    grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
    gap: 1.1rem 1.2rem;
    align-items: stretch;
  }

  /* Recettes : ton wrapper custom en cartes */
  .list-cards{
    display: grid !important;
    grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
    gap: 1.1rem 1.2rem;
  }

  /* Mes scripts : ta grille de boutons/outils */
  .tools-list{
    display: grid !important;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 1rem 1.2rem;
  }
}

/* Ultra-wide : aérer un peu */
@media (min-width: 1600px){
  .post-list{ grid-template-columns: repeat(auto-fit, minmax(360px, 1fr)); gap: 1.2rem
  }
}

/* /outils : grille dédiée, exactement 3 colonnes dès 1200px */
@media (min-width: 1200px){
  #outils-list{
    display: grid !important;
    grid-template-columns: repeat(3, minmax(0, 1fr)) !important;
    gap: 1rem 1.1rem;
  }
  #outils-list > *{
    min-width: 0 !important;   /* empêche un enfant d'élargir une colonne */
    grid-column: auto / span 1 !important;
  }
}

/* En-dessous de 1200px : biais 2 colonnes (fluide), sinon 1 */
@media (min-width: 992px) and (max-width: 1199.98px){
  #outils-list{
    display: grid !important;
    grid-template-columns: repeat(2, minmax(0, 1fr)) !important;
    gap: 1rem 1.1rem;
  }
  #outils-list > *{ min-width: 0 !important; }
}

/* Harmoniser /outils et /references avec "mes-scripts" */
#outils-list,
#refs-cards{
  font-size: 1rem !important;      /* base */
  line-height: 1.6 !important;
}

/* Titre des cartes */
#outils-list .entry-title,
#refs-cards .entry-title{
  font-size: 1.6rem !important;
  line-height: 1.3;
  margin: 0 0 .3rem 0;
}

/* Texte des cartes */
#outils-list .entry-content p,
#refs-cards .entry-content p{
  font-size: 18px !important;
  line-height: 1.6 !important;
  margin: 0;
}

/* Ne pas rétrécir via .post-entry */
#outils-list .post-entry,
#refs-cards .post-entry{
  font-size: inherit !important;
}

/* ======================================================================
   Intro box (Mes scripts) — Source de vérité unique
   - Style de base commun
   - Dark mode
   - Règle desktop spécifique à /mes-scripts : largeur 50% + alignée à gauche
   ====================================================================== */

/* Base commune */
.script-desc-box{
  display: block;                 /* format bloc */
  width: auto;                    /* suit la colonne */
  max-width: 100%;                /* ne dépasse jamais la colonne */
  margin: 1rem 0 2rem 0;          /* alignée à gauche (pas centrée) */
  padding: .85rem .9rem;          /* marges internes (confort) */
  box-sizing: border-box;
  border: 1px solid var(--border, #ddd);
  border-radius: .75rem;
  background: var(--card-bg, rgba(0,0,0,.03));
  text-align: left;               /* texte à gauche */
  white-space: normal;            /* retour à la ligne autorisé */
  overflow-wrap: anywhere;        /* casse les très longs tokens si besoin */
}
.script-desc-box p{ margin: 0; }

/* Dark mode (auto) */
@media (prefers-color-scheme: dark){
  .script-desc-box{
    border-color: rgba(255,255,255,.36);
    border-width: 2px;
    background: rgba(255,255,255,.06);
    color: rgba(255,255,255,.94);
    font-weight: 600;
    text-shadow: 0 0 6px rgba(255,255,255,.06);
    letter-spacing: .1px;
  }
  .script-desc-box a{
    color: #a5b4fc;
    text-decoration-thickness: .12em;
    text-underline-offset: .18em;
  }
}

/* Dark piloté par classe (PaperMod) */
.dark .script-desc-box,
html[data-theme="dark"] .script-desc-box{
  border-color: rgba(255,255,255,.36);
  border-width: 2px;
  background: rgba(255,255,255,.06);
  color: rgba(255,255,255,.94);
  font-weight: 600;
  text-shadow: 0 0 6px rgba(255,255,255,.06);
  letter-spacing: .1px;
}
.dark .script-desc-box a,
html[data-theme="dark"] .script-desc-box a{
  color: #a5b4fc;
  text-decoration-thickness: .12em;
  text-underline-offset: .18em;
}

/* Mes scripts — intro box à 50% alignée gauche (override robuste) */
@media (min-width: 992px){
  .post-article .script-desc-box{
    display: block !important;
    width: 50% !important;
    max-width: 50% !important;
    margin: 1rem 0 2rem 0 !important; /* alignée à gauche */
    white-space: normal !important;    /* pas de nowrap résiduel */
    text-align: left !important;
  }
}

.post-article .script-desc-box{
  text-align: center !important;
}

/* Mes scripts (SINGLES) — colonne plus étroite (920px) */

/* 1) Méthode robuste via <link rel="canonical"> (marche en prod Netlify) */
@supports selector(html:has(link[rel="canonical"])) {
  @media (min-width: 992px){
    html:has(link[rel="canonical"][href*="/mes-scripts/"]) .main,
    html:has(link[rel="canonical"][href*="/mes-scripts/"]) .post-single{
      max-width: 840px !important;
      margin-inline: auto;
      padding-inline: clamp(12px, 1.2vw, 24px);
    }
  }
}

/* 2) Fallback local (quand :has() n'est pas dispo ou pas de canonical)
      — on reconnaît un single “mes-scripts” grâce à la présence de la intro box */
@media (min-width: 992px){
  .main:has(.post-article .script-desc-box),
  .post-single:has(.post-article .script-desc-box){
    max-width: 840px !important;
    margin-inline: auto;
    padding-inline: clamp(12px, 1.2vw, 24px);
  }
}

/* ============================================================
   WRITEUPS — colonne plus étroite (TOC reste à 240px)
   ============================================================ */

/* Rappel : TOC fixe 240px (si déjà défini plus haut, ceci ne change rien) */
@media (min-width: 992px){
  :root{ --toc-width: 240px; }
}

/* Méthode 1 (prod/Netlify) : cibler les pages dont l’URL contient /writeups/ */
@supports selector(html:has(link[rel="canonical"])) {
  @media (min-width: 992px){
    html:has(link[rel="canonical"][href*="/writeups/"]) .main,
    html:has(link[rel="canonical"][href*="/writeups/"]) .post-single{
      max-width: 1080px !important;           /* ⇦ ajuste ici (900/920/960 …) */
      margin-inline: auto;
      padding-inline: clamp(12px, 1.2vw, 24px);
    }
  }
}

/* Méthode 2 (fallback en local) : si ton body expose data-url="/writeups/..." */
@media (min-width: 992px){
  body[data-url^="/writeups/"] .main,
  body[data-url^="/writeups/"] .post-single{
    max-width: 1080px !important;
    margin-inline: auto;
    padding-inline: clamp(12px, 1.2vw, 24px);
  }
}

/* Slogan home — taille fluide, pleine largeur de la colonne, lignes équilibrées */
.home-intro{
  animation: homeIntroFade .6s ease-out both;
  padding-bottom: .65rem;
  margin: 0 0 1.25rem 0;
  border-bottom: 1px solid rgba(0,0,0,.12);
}

.home-intro p{
  margin: 0;
  /* Ajuste la taille de façon fluide :
     - min lisible : 1.20rem
     - croissance fluide avec la largeur de la colonne
     - max desktop : 1.75rem (à ajuster selon ton goût) */
  font-size: clamp(1.20rem, 1.25vw + 0.95rem, 1.75rem);
  line-height: 1.42;          /* un poil serré pour “remplir” visuellement */
  text-wrap: balance;         /* équilibre les retours à la ligne */
  hyphens: auto;              /* césure si nécessaire (lang=fr-fr déjà OK) */
  word-break: normal;
  opacity: .98;
}

/* Légère montée sur grands écrans pour mieux occuper la colonne */
@media (min-width: 1280px){
  .home-intro p{
    font-size: clamp(1.25rem, 1.1vw + 1.05rem, 1.95rem);
    line-height: 1.38;
  }
}

/* Thème sombre : ligne un peu plus visible */
@media (prefers-color-scheme: dark){
  .home-intro{ border-bottom-color: rgba(255,255,255,.18); }
}

/* Accessibilité : réduit l’animation si nécessaire */
@media (prefers-reduced-motion: reduce){
  .home-intro{ animation: none; }
}

@keyframes homeIntroFade{
  from{ opacity:0; transform: translateY(6px); }
  to{   opacity:1; transform: translateY(0); }
}
